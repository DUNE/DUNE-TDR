\section{Interfaces}
\label{sec:fdsp-tpcelec-interfaces}

Table~\ref{tab:CEinterfaces} contains a brief summary of all the interfaces
between the \dword{tpc} electronics consortium and other consortia or groups,
with references to the current version of the interface documents. 
In some cases, the interface documents involve more than one 
consortium (one example is the bias voltage distribution system where
the interface involves both the \dword{apa} and the \dword{hv} consortia).
In such cases, the goal is to have all the corresponding interface documents 
consistent. At this stage, most of the interface documents are
not yet complete; drawings of the mechanical interfaces and diagrams
of the electrical interfaces are still under development. The interface 
documents should be further refined during the rest of 2019 and the 
first half of 2020 before the engineering design
reviews of the detector. All interface documents specify the responsibilities
of different consortia or groups during all phases of the experiment,
including design and prototyping, integration, installation,
and commissioning. In the remainder of this Section the most
important interfaces, with the \dword{apa}, \dword{daq}, and \dword{hv}
consortia and with technical coordination are discussed in detail.
Finally a brief overview of the remaining interfaces is also presented.

\forlbnc{The interfaces with the Calibration consortium, and with the Physics
and the Software and Computing groups have yet to be defined. Once they are
defined some text should be added in this Section and in the Table below.}

\fixme{It's not clear what we are doing with the line that refers to the interface
with the itf.}

\begin{dunetable}
[\dword{hv} system interfaces]
{p{0.25\textwidth}p{0.5\textwidth}l}
{tab:CEinterfaces}
{High voltage system interface links. }
Interfacing System & Description & Linked Reference 
\\ \toprowrule
\dword{apa} & Mechanical (cable trays, cable routing, connections of CE boxes and 
frames) and electrical (bias voltage, \dword{femb}--\dword{cr} boards connection, grounding 
scheme) & \cite{bib:docdb6670}
\\ \colhline
\dword{daq} & Data output from the \dword{wib} to the \dword{daq} back-end, clock distribution,
controls and data monitoring responsibilities & \cite{bib:docdb6742}
\\ \colhline
CISC & Rack layout, controls and data monitoring & \cite{bib:docdb6745}
\\ \colhline
\dword{hv} & Grounding, bias voltage distribution, installation and testing & \cite{bib:docdb6739}
\\ \colhline
\dword{pds} & Electrical (cable routing and installation), cold flange & \cite{bib:docdb6718}
\\ \colhline
Facility & Cable trays inside the cryostat, cryostat penetrations, rack layout and
power distribution on the detector mezzanine, cable and fiber trays on top of the
cryostat& \cite{bib:docdb6973}
\\ \colhline
Installation Team & Sequence of integration and installation activities at \surf,
equipment required for  \dword{tpc} electronics consortium activities & \cite{bib:docdb7000}
\\ \colhline
\dword{itf} & Material handling and testing activities of  the \dword{tpc} electronics 
consortium at the \dword{itf}, cold box for \dword{apa} tests& \cite{bib:docdb7027}
\\ \colhline
Calibration & TBD & \cite{bib:docdb7054}
\\ \colhline
Physics & TBD & \cite{bib:docdb7081}
\\ \colhline
Software \& Computing & TBD & \cite{bib:docdb7108}
\\
\end{dunetable}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{APA}
\label{sec:fdsp-tpcelec-interfaces-apa}

The most important interface is between the \dword{tpc} electronics
and the \dword{apa} consortia. The design of the \dwords{femb}
and of the \dword{apa}s are intertwined, both from the
mechanical and electrical points of view. The \dword{ce}
boxes, which house the \dwords{femb}, are supported by the \dword{apa}
and, at the same time, attached to the \dword{cr} boards of the \dword{apa}
through a connector that passes all signals from the wires to
the \dword{fe} amplifiers. The cable trays that house both the
\dword{ce} and the \dword{pds} cold cables are initially
attached to the yoke of the \dword{apa}. The \dword{ce}
cables for the bottom \dword{apa} must be routed through the 
frames of both the bottom and top \dword{apa}s. The \dword{tpc} electronics
consortium provides the bias voltage for the \dword{apa}
wires as well as for the electron diverters and the \dword{fc} termination electrodes (the latter are a responsibility of
the \dword{hv} consortium) using the \dword{shv} boards mounted
on the \dword{apa}s. The grounding requirements discussed in
Section~\ref{sec:fdsp-tpcelec-design-grounding} inform the
design of all mechanical and electrical interfaces between
the \dword{ce} components and \dword{apa}s as well as the
design of the connections between the top and bottom \dword{apa}s
and between the top \dword{apa} and the \dword{dss}. All 
integration and installation activities at \dword{surf}
must be carefully coordinated by the two consortia and, 
where appropriate, also with the \dword{pds} consortium 
and \dword{tc}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{DAQ}
\label{sec:fdsp-tpcelec-interfaces-daq}

The \dword{daq} is responsible for receiving the data produced by the
\dword{tpc} electronics detector components and the further processing to
form trigger decisions and later to transfer data to 
permanent storage for analysis. The 
\dword{daq} is also responsible for delivering the clock and control
signals to the \dwords{wiec}. The interfaces are realized 
through optical fibers, ensuring that no electrical noise is fed into
the \dwords{wiec}. One fiber per \dword{wiec} delivers the
clock and the control signals to the \dword{ptc}, which then
rebroadcasts the information to the \dwords{wib} in that 
crate. Each \dword{wib} reads out the data from four \dwords{femb}
and transmits the data through two \SI{10}{Gbps}links to the \dword{daq} back-end.

The data signals from the \dwords{wiec} to the \dword{daq} are carried on
multi-mode fibers, compatible with either the OM3 or OM4 standards. Individual
fibers will be merged into bundles of 12 fibers with MTP connectors near the 
\dword{ce} cryostat penetrations. These bundles will be merged in trunks of 144 
fibers on the detector mezzanine, which will then be fan out back to individual
fibers inside the \dword{cuc}. The
feasibility of this data transmission scheme using fibers with a length up
to \SI{300}{m} has been demonstrated at \dword{bnl} in Summer 2018 using 
\dword{pdsp} components. The data format used for 
\dword{dune} will be an evolution of the one adopted for
\dword{pdsp}, taking into account the need for an 
extended address space to accommodate the larger number of
\dwords{femb} in the detector. The \dword{daq} consortium
is also responsible for providing the software environment
used for downloading the detector configuration.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{HV}
\label{sec:fdsp-tpcelec-interfaces-hv}

The \dword{hv} consortium interface 
is driven by the fact that the \dword{ce} flange provides the return path for
the small current that flows from the high voltage power 
supply through the cathode panels, the \dword{fc}, and then
the termination electrodes. The hardware interface uses
the \dword{shv} boards mounted on the \dword{apa}s, which
are  the responsibility of the \dword{apa} consortium. The
\dword{shv} boards also distribute the bias voltage to the 
\dword{fc} termination electrodes. The \dword{tpc} electronics 
consortium is responsible for bringing the bias voltage for the 
\dword{fc} termination electrodes to the \dword{shv} boards. Appropriate
rules for avoiding ground loops are also included in the 
interface document.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Technical Coordination}
\label{sec:fdsp-tpcelec-interfaces-tc}

\fixme{We probably have to go down from 3 interfaces: facility, installation
team, and ITF to 2 interfaces or 1. To be discussed with Eric}

In this Section, we consider the interfaces with the facility (LBNF)
and the \dword{dune} \dword{tc}, including the
interfaces with the \dword{jpo} that oversees the integration
and installation activities that take place at \dword{surf}.
The \dword{tpc} electronics consortium has several
interfaces with the facility, namely the cable trays inside the
cryostat, the cryostat penetrations used by the \dword{tpc} electronics
and \dword{pds} consortia, and the racks and trays on top
of the cryostat. The \dword{tpc} electronics consortium is responsible
for the design, procurement, and installation of the cable trays
inside the cryostat and the cryostat penetrations. The \dword{dune}
\dword{tc} is responsible for providing the racks
where the low voltage power supplies and the bias voltage supplies are installed,
including their power, cooling, and monitoring systems, and the interlocks.
\dword{tc} is also responsible for the trays connecting these racks 
to the corresponding \dword{wiec} and for the network switches that
connect the controls for the \dword{tpc} electronics to the
\dword{daq} and \dword{cisc} back-ends. Finally, \dword{tc} will
provide the \dword{ddss} that will protect
the \dword{tpc} electronics detector components. The \dword{tpc} electronics
consortium will work with \dword{tc} to establish
the action matrix for the \dword{ddss} and the hardware
interlocks.

The \dword{tpc} electronics consortium will work with the teams responsible
for the underground integration and installation
to plan all activities that take place at the \dword{surf}.
This will include developing plans to outline the responsibilities
of the consortium and those of \dword{tc} personnel
for the activities at \dword{surf}, including all 
shipments, transport, and logistics, as well as all
integration and installation. Cold boxes for testing
the \dword{apa}s after integration with the \dwords{femb} will be 
provided by \dword{tc} at \dword{surf}.
All other testing equipment will be provided either by the \dword{tpc} electronics
consortium or by other consortia. Equipment required to
minimize risk of \dword{esd} damage to the detector components
will  be provided by the \dword{tpc} electronics consortium. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Other Interfaces}
\label{sec:fdsp-tpcelec-interfaces-other}

The interface with the \dword{pds} consortium is relatively simple.
The \dword{pds} detector component should be isolated from the \dword{ce}
detector component other than sharing a common reference 
voltage point (ground) at the chimneys. Inside the cryostat, the 
\dword{pds} and \dword{ce} cables will be housed together in
cable trays that are the responsibility of the \dword{tpc} electronics
consortium. The \dword{tpc} electronics consortium will also assume
the responsibility for routing the \dword{pds} cables through the
cryostat penetration and for connecting them to the \dword{pds}
flange. The flange itself will be designed and built by the \dword{pds}
consortium, but its testing and final integration on the spool piece
of the cryostat penetration will be a responsibility of the \dword{tpc} electronics
consortium. The \dword{tpc} electronics consortium may also
take the responsibility of connecting the 
\dword{pds} cables between the flange and the mini-racks housing
the \dword{pds} warm electronics on the top of the cryostat as
well as connecting the clock distribution system for the mini-racks.

The \dword{cisc} consortium provides the software infrastructure for the slow
control and monitoring the status of the \dword{tpc} electronics components.
The \dword{cisc} and \dword{tpc} electronics consortia may also have hardware
interfaces because they may share the same racks on top of the
cryostat. The most important aspect of the interface between these
two consortia is the requirement from the \dword{tpc} electronics consortium
to have all relevant parts of the slow control and monitoring
equipment functional at the beginning
of the installation for \dword{surf}. 
