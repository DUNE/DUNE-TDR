\section{Interfaces}
\label{sec:fdsp-tpcelec-interfaces}

Table~\ref{tab:CEinterfaces} contains a brief summary of all of the interfaces
between the \dword{tpc} electronics consortium and other consortia or groups,
with references to the current version of the interface documents. 
In some cases, the interface documents involve more than one 
consortium (one example is the bias voltage distribution system where
the interface involves both the \dword{apa} and the \dword{hv} consortia).
In such cases, the goal is to have all of the corresponding interface documents 
consistent. At this stage, most of the interface documents are
not yet complete; drawings of the mechanical interfaces and diagrams
of the electrical interfaces are still under development. The interface 
documents should be further refined during the 
first half of 2020 before the engineering design
reviews of the detector. All interface documents specify the responsibilities
of different consortia or groups during all phases of the experiment,
including design and prototyping, integration, installation,
and commissioning. In the remainder of this section, the most
important interfaces, specifically those with the \dword{apa}, \dword{daq}, and \dword{hv}
consortia, as well as the interface with technical coordination, are discussed in detail.
Finally, a brief overview of the remaining interfaces is also presented.

\begin{dunetable}
[TPC electronics system interfaces]
{p{0.25\textwidth}p{0.5\textwidth}l}
{tab:CEinterfaces}
{\dword{tpc} electronics system interfaces. }
Interfacing System & Description & Linked Reference 
\\ \toprowrule
\dword{apa} & Mechanical (cable trays, cable routing, connections of CE boxes and 
frames) and electrical (bias voltage, \dword{femb}--\dword{cr} boards connection, grounding 
scheme) & \cite{bib:docdb6670}
\\ \colhline
\dword{daq} & Data output from the \dword{wib} to the \dword{daq} back-end, clock signal distribution,
controls and data monitoring responsibilities & \cite{bib:docdb6742}
\\ \colhline
\dshort{cisc} & Rack layout, controls and data monitoring & \cite{bib:docdb6745}
\\ \colhline
\dword{hv} & Grounding, bias voltage distribution, installation and testing & \cite{bib:docdb6739}
\\ \colhline
\dword{pds} & Electrical (cable routing and installation), cold flange & \cite{bib:docdb6718}
\\ \colhline
Facility & Cable trays inside the cryostat, cryostat penetrations, rack layout and
power distribution on the detector mezzanine, cable and optical fiber trays on top of the
cryostat& \cite{bib:docdb6973}
\\ \colhline
Installation Team & Integration and installation activities at \surf,
equipment required for  \dword{tpc} electronics consortium activities, 
cold boxes for \dword{apa} tests, material handling  & \cite{bib:docdb7000}
\\ \colhline
Physics & Responsibilities for simulation and reconstruction software & \cite{bib:docdb7081}
\\ \colhline
Software \& Computing & Database needs for storing detector calibration and configurations, computing needs for calibration and monitoring & \cite{bib:docdb7108}
\\ \colhline
Calibration & Access to low-level electronics calibration for high-level physics calibration & \cite{bib:docdb7054}
\\ 
\end{dunetable}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{APA}
\label{sec:fdsp-tpcelec-interfaces-apa}

The most important interface is between the \dword{tpc} electronics
and the \dword{apa} consortia. The design of the \dwords{femb}
and of the \dword{apa}s are intertwined, both from the
mechanical and electrical points of view. The \dword{ce}
boxes, which house the \dwords{femb}, are supported by the \dword{apa}
and are attached to the \dword{cr} boards of the \dword{apa}
through a connector that passes all signals from the wires to
the \dword{fe} amplifiers. The cable trays that house both the
\dword{ce} and the \dword{pds} cold cables are initially
attached to the yoke of the upper \dword{apa}. The \dword{ce}
cables for the lower \dword{apa} must be routed through the 
frames of both the bottom and top \dword{apa}s. The \dword{tpc} electronics
consortium provides the bias voltage for the \dword{apa}
wires as well as for the electron diverters and the \dword{fc} termination electrodes (the latter are a responsibility of
the \dword{hv} consortium) using the \dword{shv} boards mounted
on the \dword{apa}s. The grounding requirements discussed in
Section~\ref{sec:fdsp-tpcelec-design-grounding} inform the
design of all mechanical and electrical interfaces between
the \dword{ce} components and \dword{apa}s as well as the
design of the connections between the top and bottom \dword{apa}s
and between the top \dword{apa} and the \dword{dss}. All 
integration and installation activities at \dword{surf}
must be carefully coordinated by the two consortia and
where appropriate also with the \dword{pds} consortium 
and \dword{tc}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{DAQ}
\label{sec:fdsp-tpcelec-interfaces-daq}

The \dword{daq} system receives the data produced by the
\dword{tpc} electronics detector components, further processes this data to
form trigger decisions, and finally transfers the data to 
permanent storage for analysis. The 
\dword{daq} system is also responsible for delivering the clock and control
signals to the \dwords{wiec}. The interfaces are realized 
through optical fibers, ensuring that no electrical noise is fed into
the \dwords{wiec}. One fiber per \dword{wiec} delivers the
clock and control signals to the \dword{ptc}, which then
rebroadcasts the information to the \dwords{wib} in that 
crate. Each \dword{wib} reads out the data from four \dwords{femb}
and transmits the data through two \SI{10}{Gbps} links to the \dword{daq} back-end.

The data signals from the \dwords{wiec} to the \dword{daq} system are carried on
multi-mode optical fibers, compatible with either the \dword{om3} or \dword{om4} standards. Individual
fibers will be merged into bundles of 12 fibers with MTP connectors near the 
\dword{ce} cryostat penetrations. These bundles will be merged in trunks of 144 
fibers on the detector mezzanine, which will then be fanned out to individual
optical fibers inside the \dword{cuc}. The
feasibility of this data transmission scheme using optical fibers with a length up
to \SI{300}{m} has been demonstrated at \dword{bnl} in summer 2018 using 
\dword{pdsp} components. The data format used for 
\dword{dune} will be a modification of the one adopted for
\dword{pdsp}, taking into account the need for an 
extended address space to accommodate the larger number of
\dwords{femb} in the detector. The \dword{daq} consortium
is also responsible for providing the software environment
used for downloading the detector configuration.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{HV}
\label{sec:fdsp-tpcelec-interfaces-hv}

The \dword{hv} consortium interface 
is driven by the fact that the \dword{ce} flange provides the return path for
the small current that flows from the high-voltage power 
supply through the cathode panels, the \dword{fc}, and finally
the termination electrodes. The hardware interface uses
the \dword{shv} boards mounted on the \dword{apa}s, which
are  the responsibility of the \dword{apa} consortium. The
\dword{shv} boards also distribute the bias voltage to the 
\dword{fc} termination electrodes. The \dword{tpc} electronics 
consortium is responsible for bringing the bias voltage for the 
\dword{fc} termination electrodes to the \dword{shv} boards. Appropriate
rules for avoiding ground loops are also included in the 
interface document.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Technical Coordination}
\label{sec:fdsp-tpcelec-interfaces-tc}

In this section, we consider the interfaces with \dword{lbnf} %the facility (LBNF)
and with the \dword{dune} \dword{tc}, including the
interfaces with the \dword{jpo} that oversees the integration
and installation activities that take place at \dword{surf}.
The \dword{tpc} electronics consortium has several
interfaces with the facility, namely the cable trays inside the
cryostat, the cryostat penetrations used by the \dword{tpc} electronics
and \dword{pds} consortia, and the racks and trays on top
of the cryostat. The \dword{tpc} electronics consortium is responsible
for the design, procurement, and installation of the cable trays
inside the cryostat and the cryostat penetrations. The \dword{dune}
\dword{tc} is responsible for providing the racks
where the low-voltage power supplies and the bias voltage supplies are installed,
including their power, cooling, and monitoring systems, as well as the hardware interlock system.
\Dword{tc} is also responsible for the trays connecting these racks 
to the corresponding \dword{wiec} and for the network switches that
connect the controls for the \dword{tpc} electronics to the
\dword{daq} and slow controls back-ends. Finally, \dword{tc} will
provide the \dword{ddss} that will protect
the \dword{tpc} electronics detector components. The \dword{tpc} electronics
consortium will work with \dword{tc} to establish
the action matrix for the \dword{ddss} and the hardware
interlocks, and also to resolve any electronics noise problems
that may be caused by improper grounding of detector components.

The \dword{tpc} electronics consortium will work with the teams responsible
for the underground integration and installation in order
to plan all activities that take place at \dword{surf}.
This includes developing plans to outline the responsibilities
of the consortium and those of \dword{tc} personnel
for the activities at \dword{surf}, including all 
shipments, transport, and logistics, as well as all
integration and installation. Cold boxes for testing
the \dword{apa}s after integration with the \dwords{femb} will be 
provided by \dword{tc} at \dword{surf}.
All other testing equipment will be provided either by the \dword{tpc} electronics
consortium or by other consortia. Equipment required to
minimize risk of \dword{esd} damage to the detector components
will  be provided by the \dword{tpc} electronics consortium. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Other Interfaces}
\label{sec:fdsp-tpcelec-interfaces-other}

The interface with the \dword{pds} consortium is relatively simple.
The \dword{pds} detector component should be isolated from the \dword{ce}
detector component other than sharing a common reference 
voltage point (detector ground) at the chimneys. Inside the cryostat, the 
\dword{pds} and \dword{ce} cables will be housed together in
cable trays that are the responsibility of the \dword{tpc} electronics
consortium. The \dword{tpc} electronics consortium will also assume
the responsibility for routing the \dword{pds} cables through the
cryostat penetration and for connecting them to the \dword{pds}
flange. The \dword{tpc} electronics consortium will also connect
the cables that run from the flange
to the mini-racks housing the \dword{pds} warm electronics. 
The flange itself will be designed and built by the \dword{pds}
consortium, but its integration on the spool piece
of the cryostat penetration will be the responsibility of the \dword{tpc} electronics
consortium.

The \dword{cisc} consortium provides the software infrastructure for the slow
control and monitoring of the status of the \dword{tpc} electronics components.
The \dword{cisc} and \dword{tpc} electronics consortia may also have hardware
interfaces because they may share the same racks on top of the
cryostat. The most important aspect of the interface between these
two consortia is the requirement from the \dword{tpc} electronics consortium
to have all relevant parts of the slow control and monitoring
equipment functional at the beginning
of the installation for \dword{surf}. 

The \dword{tpc} electronics consortium is responsible for many parts of
the \dword{dune} simulation and reconstruction software, which constitute
the interface with the Physics group. These include the
simulation of the material of the detector components (\dwords{femb}, cables, and
cable trays) inside the \dword{lar}, the simulation
of the response of the electronics, from the signal formation to its 
digitization, and finally the methods for the deconvolution of the electronics
response to be used in the event reconstruction software (the latter responsibility is shared 
with the \dword{apa} consortium). Many of these
software tools  already exist and have been used for the simulation
and the reconstruction of \dword{pdsp}. In the coming years they will be
updated to reflect the changes to the detector design relative to 
\dword{pdsp}. Similarly, the \dword{tpc}
electronics consortium has an interface with the Software and Computing
consortium that covers mostly the need for data storage and data access.
This includes both database needs (for storing detector calibration constraints
and detector configurations) and disk space needs (for storing the data 
from special calibration runs that are used to obtain the calibration
data). The calibration data on the response shape of the electronics and
on its gain are also relevant to the Calibration consortium,
which is tasked with obtaining high-level calibrations of the detector
response. When doing this, the most up-to-date electronics calibrations,
or in some cases special electronics calibrations, will be required.
