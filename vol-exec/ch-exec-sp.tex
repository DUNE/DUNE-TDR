\chapter{Single-Phase Far Detector Technology}
\label{ch:exec-sp}

\section{Overview}
\label{sec:exec-sp-over}

This chapter gives an overview of the basic operating principles of a \dword{sp} \dword{lartpc}, followed by a description of the \dword{dune} implementation. It then discusses each of the subsystems separately, connecting the design to the overriding physics goals of \dword{dune}.

Figure~\ref{fig:LArTPC} shows the general operating principle of a \dword{sp} \dword{lartpc}. A large volume of \dword{lar} is subjected to a strong \efield of a few hundred volts per centimeter. Charged particles passing through the detector ionize the argon atoms, and the ionization electrons drift in the \efield to the anode wall (called an \dword{apa} array) on a timescale of milliseconds. The \dword{spmod} \dword{apa}s consist of layers of active wires strung at angles to each other to form a grid. The relative voltage between the layers is chosen to ensure that all but the final layer are transparent to the drifting electrons, and these first layers produce bipolar induction signals as the electrons pass through them. The final layer collects the drifting electrons, resulting in a monopolar signal.

\begin{dunefigure}[The single-phase liquid argon time-projection chamber]{fig:LArTPC}
{The general operating principle of the single-phase liquid argon time-projection chamber.}
\includegraphics[trim={5cm 0 5cm 0},clip,width=0.8\textwidth]{graphics/TheBoPicture.pdf}
\end{dunefigure}

\dword{lar} is also an excellent scintillator, emitting \dword{vuv} light at a wavelength of \SI{126.8}{\nano\meter}. This fast scintillation light, which crosses the detector on a timescale of nanoseconds, is shifted into the visible and collected by \dwords{pd}. The \dword{pd}s can provide a $t_{0}$ determination for events, indicating when the ionization electrons began to drift. Relative to this $t_{0}$, the time at which the ionization electrons reach the anode allows reconstruction of the event topology along the drift direction, which is crucial to fiducialize nucleon-decay events and to apply drift corrections to the ionization charge.

The pattern of current observed on the grid of anode wires provides the information for reconstruction in the two coordinates perpendicular to the drift direction. The wire pitch on the wire layers is chosen to optimize considerations of  spatial resolution, cost, and \dword{s/n} of the ionization measurement. \dword{s/n} is an important consideration because the measurement of the ionization collected is a direct measurement of the $dE/dx$ of the charged particles, which is what enables both calorimetry and particle identification.


\begin{dunefigure}[A $\SI{10}{\kilo\tonne}$ DUNE \dshort{spmod}]{fig:DUNESchematic}{A \nominalmodsize DUNE \dword{fd} \dword{spmod}, showing alternating anode (A) and cathode (C) arrays, as well as the \dword{fc} that surrounds the drift regions between the anode and cathode arrays.}
\includegraphics[width=0.8\textwidth]{DUNESchematic.pdf}
\end{dunefigure}

Figure~\ref{fig:DUNESchematic} shows a \nominalmodsize \dword{spmod}. Inside a cryostat of outer dimensions \cryostatlen (L) by \cryostatwdth (W) by \cryostatht{} (H), shown in Figure~\ref{fig:Cryostat}, four \spmaxdrift drift volumes are created between five alternating \dword{apa} and \dword{cpa} arrays, each of dimensions \sptpclen (L) by \tpcheight (H).

\begin{dunefigure}[A \dshort{fd} cryostat]{fig:Cryostat}{A  \cryostatlen (L) by \cryostatwdth (W) by \cryostatht{} (H) outer-dimension cryostat that houses a DUNE \nominalmodsize module.}
\includegraphics[width=0.8\textwidth]{cryostat.pdf}
\end{dunefigure}

The target purity from electronegative contaminants in the argon is $<\!\!100$\,ppt O$_{2}$ equivalent, which is enough to ensure a $>\!\!\SI{3}{\milli\second}$ ionization-electron lifetime at the nominal \SI{500}{\volt/\centi\meter} drift voltage. This target electron lifetime ensures \dword{s/n} of $>5$ for the induction planes and $>10$ for the collection planes, which are necessary to perform pattern recognition and two-track separation. 

Nitrogen contamination must be $<\!25$\,ppm. This is necessary to ensure we achieve our requirement of at least 0.5 \phel{}s per MeV detected for events in all parts of the detector, which in turn ensures %, through the timing requirements discussed in Section~\ref{sec:fdsp-exec-pds}, 
that we can fiducialize nucleon decay events throughout the detector.

\section{Anode Planes}
\label{sec:exec-sp-apa}

The modular anode walls are each made up of 50 \dword{apa}s (25 along the \dword{tpc} length, and two high) that are $\SI{6}{\meter}\times\SI{2.3}{\meter}$ in dimension. A schematic and a photo are shown in Figure~\ref{fig:APA}. As shown in Figure~\ref{fig:APAStack}, the \dword{apa}s hang vertically. The \dword{apa}s are two-sided, with three active wire layers and an additional shielding layer, also called a grid layer, wrapped around them. The wire spacing on the layers is $\sim\!\SI{5}{\mm}$. The collection layer is called the $X$ layer; the induction layer immediately next to that is called the $V$ layer; the next induction layer is the $U$ layer; and the shielding layer is the $G$ layer. $X$ layer and $G$ layer wires run vertically when installed  (shown horizontal in Figure~\ref{fig:APA}); the $U$ and $V$ layer wires are at $\pm\SI{35.7}{\degree}$ to the vertical. The 
wire spacing on each plane defines the spatial resolution of the \dword{apa}; it is wide enough to keep readout costs low and \dword{s/n} high, but small enough to enable reconstruction of 
short tracks such as few-\si{\cm} kaon tracks from proton-decay events.

\begin{dunefigure}[An anode plane assembly]{fig:APA}
{Top: a schematic of an \dword{apa}. The steel \dword{apa} frame is shown in black. The green and pink lines indicate the directions of the induction wire layers. The blue lines indicate the directions of the induction and shielding (grid) wire layers. The blue boxes at the right-hand end  are the \dword{ce}. Bottom: a \dword{protodune} \dword{apa} in a wire-winding machine. The right-hand end of the \dword{apa} as shown in this photograph is the head end, onto which the \dword{ce} are mounted.}
\includegraphics[width=0.7\textwidth]{APASchematic.pdf}
\includegraphics[width=0.6\textwidth]{RealAPA.pdf}
\end{dunefigure}

\begin{dunefigure}[A stack of two anode plane assemblies]{fig:APAStack}
{Left: two \dword{apa}s linked together to form one unit of an \dword{apa} array. \dword{pd} bars can be seen installed across the width of the \dword{apa}s. Right: a zoom into only the top and bottom ends of the \dword{apa} stack (note the white slashes through the images). This shows the readout electronics, and the center of the stack where the \dword{apa}s are connected together.}
\includegraphics[width=\textwidth]{graphics/APAStack.pdf}
\end{dunefigure}

\section{Cathode Planes and High Voltage}

Each of the module's two \dword{cpa} arrays is formed from 150 \dword{cpa}s (50 along the length, stacked three high), each of which is a $\SI{1.2}{\meter}\times\SI{4}{\meter}$ resistive panel. Each \dword{cpa} has its own independent \dword{hv} supply, providing a current of \SI{0.16}{\milli\ampere} at \sptargetdriftvolt{}. 
With the  \dword{apa} arrays held close to ground, this results in a uniform \spmaxfield \efield across the drift volume.  A typical \dword{mip} passing through the argon produces roughly 60k ionization electrons per centimeter that drift towards the anodes at approximately $\SI{1.6}{\mm/\micro\second}$. The time to cover the full drift distance is about $\SI{2.4}{\milli\second}$.

A \dword{fc} built from field-shaping aluminum profiles surrounds the drift volumes, keeping  the \efield uniform throughout the active \dword{tpc} volume to within 1\%.  The aluminum profiles are connected together via a resistive divider chain; between each profile, two \SI{5}{\giga\ohm} resistors, arranged in parallel, provide a \SI{2.5}{\giga\ohm} resistance to create a nominal \SI{3}{\kilo\volt} drop. The \dword{fc} is illustrated in Figure~\ref{fig:FieldCage}.

\begin{dunefigure}[A section of the field cage]{fig:FieldCage}
{A section of the field cage, showing the extruded aluminium field-shaping profiles, with white polyethylene caps on the ends to prevent discharges.}
\includegraphics[width=0.5\textwidth]{FieldCage.pdf}
\end{dunefigure}

\section{Electronics}
\label{sec:exec-sp-electronics}

\Dword{fe} readout electronics (in the \dword{lar}), called \dword{ce}, are attached to the top end of the top \dword{apa} and the bottom end of the bottom \dword{apa}. These \dword{fe} electronics benefit from the low \dword{lar} temperature due to the reduction of thermal noise. The \dword{fe} electronics shape, amplify, and digitize the signals from the \dword{apa}s' induction and collection wires thanks to a series of three different types of \dwords{asic} through which all signals pass. 
Outside the cryostat, signals are passed to \dwords{wib} that put the signals onto \SI{10}{\giga\byte} optical fibers, ten per \dword{apa}, which carry the signals to the upstream \dword{daq} system located in the \dword{cuc}. Each \dword{detmodule} has an independent \dword{daq} system that allows it to run as an independent detector, thereby minimizing any chance of a complete \dword{fd} outage. Modules can, however, provide the others with a \dword{snb} trigger signal. The \dword{daq} system also provides the detector clock. 

To enable us to look at low-energy particles, we aim to keep noise below $1000\,e^{-}$ per channel, which should be compared to the 20k--30k $e^{-}$ per channel collected from a \dword{mip} traveling parallel to the wire plane and perpendicular to the wire orientation. For large signals, we require a linear response up to 500k $e^{-}$, which ensures that fewer than 10\% of beam events experience saturation. This can be achieved using 12\, \dword{adc} bits. In addition, the electronics are designed with a \dword{fe} peaking time of \SI{1}{\micro\second}, which matches the time for the electrons to drift between wire planes on the \dword{apa}; this leads to a design sampling frequency of \SI{2}{\mega\hertz} to satisfy the Nyquist criterion.

\section{Photon Detection System}
\label{sec:fdsp-exec-pds}

In addition to the ionization, charged particles passing through the argon produce approximately 24,000 scintillation photons per \si{\mega\electronvolt}. The scintillation photons are fast, arriving at a \dwords{pd} nanoseconds after production. This scintillation light provides a $t_{0}$ for each event. Comparison of the arrival time of ionization at the anode with this $t_{0}$ enables reconstruction in the drift direction. 
The \dword{spmod} implemenation enables $\sim\,\SI{1}{\mm}$ position resolution for \SI{10}{\mega\electronvolt} \dword{snb} events. The \dword{pd} $t_{0}$ is also vital in fiducializing nucleon-decay events, which allows us to reject cosmic-muon-induced background events that will occur near the edges of the detector modules.

The photons are collected by devices called \dwords{xarapu}\footnote{An ``arapuca'' is a South American bird trap, the name is used here in analogy to the way the devices trap photons.}, which are mounted in the \dword{apa} frames between the sets of wire layers, as shown in Figure~\ref{fig:APAStack}. 
The \dword{xarapu} bars consist of layers of dichroic filter and wavelength-shifter, illustrated in Figure~\ref{fig:ArapucaCell}, that shift the \dword{vuv} scintillation light into the visible and trap these visible photons, transporting them to \dword{sipm} devices. \dword{pd} modules are shown in Figure~\ref{fig:PDModules}. The signals from these \dwords{sipm} are sent along cables that pass through the hollow \dword{apa} frames, up to feedthroughs in the cryostat roof. The \dword{pd} and \dword{apa}-wire data-streams are merged at the \dword{daq}.

\dword{pd} modules, shown in Figure~\ref{fig:PDModules}, are 
$\SI{209}{\cm}\times\SI{12}{\cm}\times\SI{2}{\cm}$ bars, ten of which are mounted in each \dword{apa} between the wire layers. Each bar contains 24 \dwords{xarapu}.


\begin{dunefigure}[Photon detector modules mounted in an APA]{fig:PDModules}
{Left: an \dword{xarapu} \dword{pd} module. The 48 \dwords{sipm} that detect the light from the 24 cells are along the long edges of the module. Right: \dword{xarapu} \dword{pd} modules mounted inside an \dword{apa}.}
\includegraphics[width=0.49\textwidth]{PDBar.pdf}
\includegraphics[width=0.49\textwidth]{PDsInAPA.pdf}
\end{dunefigure}

\begin{dunefigure}[An \dshort{xarapu} photon detector cell]{fig:ArapucaCell}
{Left: an X-Arapuca cell. Right: an exploded view of the\dword{xarapu} cell, where the blue sheet is the \dword{wls} plate and the yellow sheets are the dichroic filters.}
\includegraphics[width=\textwidth]{XArapuca.pdf}
\end{dunefigure}

The 48 \dword{sipm}s on each \dword{xarapu} supercell are ganged together and the signals are collected by \dword{fe} electronics, mounted on the supercell. The design of the \dword{fe}  electronics is inspired by the system used for the \dword{mu2e} cosmic-ray tagger~\cite{bib:mu2e_tdr}, which uses commercial ultrasound \dwords{asic}. The \dword{fe} electronics define the \SI{1}{\micro\second} timing resolution of the \dword{pd} system.



\section{Data Acquisition}
\label{sec:exec-sp-daq}


The \dword{daq} is divided between an upstream section, located underground in the \dword{cuc}, and a downstream \dword{daqbes} above ground at \dword{surf}. All trigger decisions are made underground, and the data is buffered underground until the \dword{daqbes} indicates it is ready to receive data, in order to minimize the rate of data flowing to the surface. An end-goal of the \dword{daq} is to achieve a data-rate to tape of no more than \SI{30}{\peta\byte/\year}.

The \dword{daq} architechture is based on the \dword{felix} system designed at \dword{cern} and used for the \dword{lhc} 
experiments. The 150 \dword{apa}s are processed by 75 \dword{daqrou}; each \dword{daqrou} contains one \dword{felix} board. The \dwords{pd} from the module will have a lower data-rate since the \dword{pd} electronics, unlike that of the \dword{tpc}, perform zero-suppression; therefore the \dwords{pd} of a module will be processed by six to eight additional \dwords{daqrou}. The \dword{daq} will be partitionable: it will be possible to run multiple instances of the \dword{daq} simultaneously so that the majority of the detector can be taking physics data while other \dword{daq} instances are running test runs for development or special runs such as calibration runs. A key philosophy is that all the primary \dword{dune} physics goals can be achieved using only the \dword{tpc} as the trigger; information from the \dwords{pd} can then further enhance the trigger.

There will be two basic triggers operating. Beam, cosmic and nucleon decay events will be triggered using the localized high-energy trigger %. This will trigger on localized regions of visible activity, for example in a single \dword{apa}, with a $>99\%$ trigger efficiency at \SI{100}{\mega\electronvolt} and a trigger threshold as low as \SI{10}{\mega\electronvolt}. A localized high-energy trigger 
that will open a readout window of \SI{5.4}{\ms}, enough to readout the full \dword{tpc} drift around an event. For \dwords{snb}, we will use an extended low-energy trigger. This will look for coincident regions of low-energy deposits, below \SI{10}{\mega\electronvolt}, across an entire module and in a \SI{10}{\second} period. An extended high-energy trigger will open a readout window of \SI{100}{\second} to capture a full \dword{snb}. %The upstream \dword{daq} identifies per-channel regions of interest and forms them into \dwords{trigprimitive}. These are then formed into trigger candidates that contain information from an entire module; on these trigger candidates, trigger decisions are made. Once a trigger decision has been made, this will be communicated to the surface, and the data buffered underground until the \dword{daqbes} indicates it is ready to receive data.

The \dword{daq} must also provide the system clock that keeps the detector components synchronized and provides the timestamp for all data. The timestamp derives from a \dword{gps} \dword{pps} that is fed into the \dword{daq} with \SI{1}{\micro\second} precision, adequate to timestamp beam and supernova events. To provide the finer synchronization between detector components, a \SI{10}{\mega\hertz} reference clock drives the module's \SI{62.5}{\mega\hertz} masterclock, which is fanned out to all detector components, providing an overall synchronization to a precision of \SI{1}{\nano\second}.

\section{Calibration}
\label{sec:exec-sp-calibration}

The challenge of calibrating the \dword{dune} \dword{fd} is to control the response of a huge cryogenic detector over a period of decades, a challenge amplified by the detector's location deep underground and therefore shielded from the cosmic muons that have been typically used as standard candles by previous \dword{lartpc}s.

To achieve our $\mathcal{O}(\si{\giga\electronvolt})$ oscillation and nucleon decay physics goals, we must know our fiducial volume to 1--2\% and have a similar understanding of the vertex position resolution; understand the \nue event rate to 2\%; and control our lepton and hadron energy scales to 1\% and 3\%, respectively. At the $\mathcal{O}(\si{\mega\electronvolt})$ scale our physics requirements are driven by our goal of identifying, and measuring the spectral structure of, a \dword{snb}; here, we must achieve a 20--30\% energy resolution, understand our event timing to the \SI{1}{\micro\second} level, and measure our trigger efficiency and levels of radiological background. %These are all high-level calibration requirements, but the underlying detector parameters that we are characterizing are parameters such as the energy deposted per unit length ($\mathrm{d}E/\mathrm{d}x$), ionization electron drift-lifetimes, scintillation light yield and detection efficiency, \efield maps, timing precision, \dword{tpc} alignment, and the behavior (noise, gain, cross-talk, linearity, etc.) of electronics channels.

The tools available to us for calibration include the \dword{lbnf} beam, atmospheric neutrinos, atmospheric muons, radiological backgrounds, and dedicated calibration devices that will be installed in the detector. At the lowest energies, we have deployable neutron sources and intrinsic radioactive sources; in particular the natural $^{39}$Ar component of the \dword{lar} with its \SI{565}{\kilo\electronvolt} end-point can, given its pervasive nature across the detector, be used to measure the spatial and temporal variations in electron lifetime. The possibility of deploying radioactive sources is also being explored. In the \SIrange{10}{100}{\mega\electronvolt} energy range we will use Michel electrons, photons from $\pi^{0}$ decay, stopping protons, and both stopping and through-going muons. We will also have built-in lasers, purity monitors and thermometers, and the ability to inject charge into the readout electronics. Finally, data from the \dword{protodune} detectors will be invaluable in understanding the response and \dword{pid} capabilities of the \dword{fd}.

%Once the first \SI{10}{\kilo\tonne} module is switched on, there will be a period of years before \dword{lbnf} beam sources are available for calibration --- and even then the statistics will be limited. In this time, cosmic muons will be available, but the low rate of these means that it will take months to years to build up the necessary statistics for calibration. The inclusive cosmic muon rate for each \SI{10}{\kilo\tonne} module is $1.3\times 10^{6}$ per year. However, for calibrations such as \dword{apa} alignment, the typical rate of useful muons is 3000--4000 per \dword{apa} per year. For energy-scale calibrations, stopping cosmic muons are the most relevant and here the rate is 11,000 per \nominalmodsize module per year. Therefore the earliest calibrations will come from dedicated calibration hardware systems and intrinsic radiological sources.

Over time, the \dword{fd} calibration program will evolve as statistics from the cosmic rays and the \dword{lbnf} beam amass and add to the information gained from the calibration hardware systems. These numerous calibration tools will work alongside the detector monitoring system, the \dword{cfd} models of the argon flow, and \dword{protodune} data to give us a detailed understanding of the \dword{fd} response across the \dword{dune} physics program.


\section{Installation}

A major challenge in building the \dword{dune} \dword{sp} modules is transporting all the detector and infrastructure components down the \SI{1500}{\meter} Ross shaft, to the detector caverns. To aid the planning of the installation phase, installation tests will be performed at \dword{ashriver}. These tests will allow us to develop our procedures, train the installation workers, and develop our labor planning through time and motion studies. Throughout the project, safety, \dword{qa} and \dword{qc} are written into all processes.

Once the \dword{spmod}'s cryostat is ready, %has been installed, 
a \dword{tco} is left open at one end through which the detector components are installed. A cleanroom is built around the \dword{tco} to prevent any contamination entering the cryostat during installation. The \dword{dss} is then installed into the cryostat, ready to receive the \dword{tpc} components. 


Safety of both personnel and  detector components, is the paramount consideration throughout the installation process and beyond. Once the detectors are taking data, %safety is still the priority with 
the \dword{ddss} will be monitoring for argon level drops, water leaks and smoke. A detailed detector and cavern grounding scheme has been developed that not only guards against ground loops, but also ensures that any power faults are safely shunted to the facility ground.



